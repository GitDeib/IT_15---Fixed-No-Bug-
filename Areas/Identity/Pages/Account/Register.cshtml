@page
@model RegisterModel
@{
    ViewData["Title"] = "Register";
}
 
<div class="container-fluid py-5 animate-fade-in-up delay-1 bg-image">
@*     <spline-viewer loading-anim-type="spinner-big-dark" url="https://prod.spline.design/h2gZA2ogowIh-c7m/scene.splinecode" class="spline-body-bg"></spline-viewer>
 *@    <div class="row align-items-center">

        <!-- Left: Content -->
        <div class="col-md-6 text-center text-md-start px-5" style="color: white;">
            <h1 class="text-center mb-4">
                <img src="~/lib/lg.jpg" alt="Rider Logo" style="height: 140px; border-radius: 50%; border: 2px solid #ffffff; box-shadow: 0 0 8px #000000;" />
                <span style="font-family: 'Poppins', sans-serif; font-weight: 600;">SundoGo</span>
            </h1>
            <div class="text-center">
                <p>Already have an account?</p>
                <form method="get" asp-page="/Account/Login">
                    <button type="submit" class="w-25 btn btn-light btn-md mt-2 hover-white">Login</button>
                </form>

            </div>
        </div>

        <div class="col-md-6 animate-fade-in">
            <form id="registerForm" asp-route-returnUrl="@Model.ReturnUrl" method="post" class="border p-4 shadow-sm rounded bg-white" enctype="multipart/form-data">
                <h4 class="text-center mb-4">Create an Account</h4>

                <div asp-validation-summary="ModelOnly" class="text-danger mb-3" role="alert"></div>

                <div class="row g-3">
                    <!-- First Name -->
                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="Input.FirstName" type="text" class="form-control" placeholder="First Name" required />
                            <label>First Name</label>
                            <span asp-validation-for="Input.FirstName" class="text-danger small"></span>
                        </div>
                    </div>

                    <!-- Middle Name -->
                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="Input.MiddleName" type="text" class="form-control" placeholder="Middle Name (optional)" />
                            <label>Middle Name (optional)</label>
                        </div>
                    </div>

                    <!-- Last Name -->
                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="Input.LastName" type="text" class="form-control" placeholder="Last Name" required />
                            <label>Last Name</label>
                            <span asp-validation-for="Input.LastName" class="text-danger small"></span>
                        </div>
                    </div>

                    <!-- Contact Number -->
                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="Input.PhoneNumber" type="text" class="form-control" placeholder="0912..." required />
                            <label>Contact Number</label>
                            <span asp-validation-for="Input.PhoneNumber" class="text-danger small"></span>
                        </div>
                    </div>

                    <!-- Address -->
                    <div class="col-md-12">
                        <div class="form-floating">
                            <input asp-for="Input.Address" type="text" class="form-control" placeholder="Address" required />
                            <label>Address</label>
                            <span asp-validation-for="Input.Address" class="text-danger small"></span>
                        </div>
                    </div>

                    <!-- Email -->
                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="Input.Email" class="form-control" placeholder="Email" autocomplete="username" required />
                            <label asp-for="Input.Email">Email</label>
                            <span asp-validation-for="Input.Email" class="text-danger small"></span>
                        </div>
                    </div>

                    <!-- Profile Photo -->
                    <div class="col-md-6">
                        <label class="form-label">Profile Photo (optional)</label>
                        <input asp-for="Input.ProfilePhoto" type="file" class="form-control" accept=".jpg,.jpeg,.png"/>
                    </div>

                    <!-- Password -->
                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="Input.Password" class="form-control" placeholder="Password" autocomplete="new-password" required />
                            <label asp-for="Input.Password">Password</label>
                            <span asp-validation-for="Input.Password" class="text-danger small"></span>
                        </div>
                    </div>

                    <!-- Confirm Password -->
                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="Input.ConfirmPassword" class="form-control" placeholder="Confirm Password" autocomplete="new-password" required />
                            <label asp-for="Input.ConfirmPassword">Confirm Password</label>
                            <span asp-validation-for="Input.ConfirmPassword" class="text-danger small"></span>
                        </div>
                    </div>

                    <!-- Terms and Conditions Checkbox -->
                    <div class="col-12">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="termsCheckPass" required>
                            <label class="form-check-label" for="termsCheck">
                                <p>
                                    I have read and agree to the
                                    <a href="#" data-bs-toggle="modal" data-bs-target="#termsandconModalPass">Terms and Conditions</a>.
                                </p>
                            </label>
                        </div>
                    </div>

                    <!-- Submit Button (Full width) -->
                    <div class="col-md-12 text-center">
                        <button id="registerSubmit" type="submit" class="btn btn-dark btn-lg mt-3 w-100 hover-dark" disabled>Sign Up</button>
                    </div>
                </div>
            </form>
        </div>


    </div>
</div>


<!-- Terms and Condition  -->
<div class="modal fade" id="termsandconModalPass" tabindex="-1" aria-labelledby="termsandcon" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-dark text-white">
                <h5 class="modal-title" id="chooseOptionModalLabel">Terms and Conditions</h5>
            </div>

            <div class="modal-body">
                <div class="container">
                    <div class="modal-body">
                        <h6>1. Introduction</h6>
                        <p>By registering as a passenger on our ride-hailing platform, you agree to the following Terms and Conditions. If you do not agree with these terms, please do not use our services.</p>

                        <h6>2. Eligibility</h6>
                        <ul>
                            <li>Be at least 18 years of age or have the consent of a parent or legal guardian.</li>
                            <li>Provide accurate and up-to-date personal information during registration.</li>
                        </ul>

                        <h6>3. Account Responsibility</h6>
                        <ul>
                            <li>You are responsible for maintaining the confidentiality of your account credentials.</li>
                            <li>Do not share your account with others or allow unauthorized access.</li>
                            <li>You are accountable for all activities conducted under your account.</li>
                        </ul>

                        <h6>4. Booking and Ride Conduct</h6>
                        <p>By using the platform to book rides, you agree to:</p>
                        <ul>
                            <li>Be respectful to drivers and follow appropriate conduct during rides.</li>
                            <li>Provide accurate pickup and drop-off details.</li>
                            <li>Refrain from any abusive, inappropriate, or illegal behavior during a ride.</li>
                        </ul>

                        <h6>5. Fare and Payments</h6>
                        <ul>
                            <li>All fares are calculated based on distance, time, and applicable platform fees.</li>
                            <li>You agree to pay the fare as shown before or after a trip.</li>
                            <li>Additional charges may apply (e.g., waiting time, cancellations, etc.).</li>
                            <li>All payments are to be made through the approved payment methods provided by the platform.</li>
                        </ul>

                        <h6>6. Cancellation Policy</h6>
                        <p>You may cancel a ride under the conditions defined by the platform.</p>

                        <h6>7. Safety and Security</h6>
                        <ul>
                            <li>Always verify driver and vehicle details before starting your ride.</li>
                            <li>Report any suspicious or inappropriate behavior via the platform’s support channels.</li>
                        </ul>

                        <h6>8. Prohibited Activities</h6>
                        <ul>
                            <li>Using the platform for illegal or fraudulent purposes.</li>
                            <li>Harassing, threatening, or harming drivers or other users.</li>
                            <li>Creating multiple accounts to misuse promotions or referrals.</li>
                        </ul>

                        <h6>9. Termination</h6>
                        <p>The platform may suspend or terminate your access for reasons including but not limited to:</p>
                        <ul>
                            <li>Violation of any of these Terms and Conditions.</li>
                            <li>Misuse or abuse of the platform or its services.</li>
                            <li>Fraudulent activity or providing false information.</li>
                        </ul>

                        <h6>10. Indemnification</h6>
                        <p>You agree to indemnify and hold harmless the platform and its affiliates from any claims, losses, or damages arising from your misuse of the platform or violation of these terms.</p>

                        <h6>11. Limitation of Liability</h6>
                        <p>The platform is not liable for any indirect, incidental, or consequential damages arising from your use of the platform, except where prohibited by law.</p>

                        <h6>12. Privacy and Data Use</h6>
                        <p>By using the platform, you consent to the collection and use of your personal data as described in the platform’s Privacy Policy. Your data is used to facilitate bookings, process payments, and ensure platform security.</p>

                        <h6>13. Changes to Terms</h6>
                        <p>We may update these Terms and Conditions at any time. Continued use of the platform signifies your acceptance of the revised terms.</p>

                        <h6>14. Governing Law</h6>
                        <p>These terms shall be governed by the laws of the jurisdiction in which the platform operates.</p>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-dark" data-bs-dismiss="modal">I Accept</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const checkbox = document.getElementById('termsCheckPass');
        const regbtn = document.getElementById('registerSubmit');

        checkbox.addEventListener('change', function () {
            regbtn.disabled = !this.checked;
        });
    });
</script>

<script type="module" src="https://unpkg.com/@@splinetool/viewer@1.9.86/build/spline-viewer.js"></script>

    <script>
document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("registerForm");
    const submitBtn = document.getElementById("registerSubmit");
    const termsCheckbox = document.getElementById("termsCheckPass");

    const inputs = {
        firstName: form.querySelector('[name="Input.FirstName"]'),
        middleName: form.querySelector('[name="Input.MiddleName"]'),
        lastName: form.querySelector('[name="Input.LastName"]'),
        phone: form.querySelector('[name="Input.PhoneNumber"]'),
        address: form.querySelector('[name="Input.Address"]'),
        email: form.querySelector('[name="Input.Email"]'),
        password: form.querySelector('[name="Input.Password"]'),
        confirmPassword: form.querySelector('[name="Input.ConfirmPassword"]')
    };

    // Track if user has interacted with each field
    const touched = {};

    Object.entries(inputs).forEach(([key, input]) => {
        const span = document.createElement("div");
        span.classList.add("text-danger", "small");
        span.style.marginTop = "4px";
        input.parentNode.appendChild(span);
        input._errorSpan = span;

        touched[key] = false;

        input.addEventListener("input", () => {
            touched[key] = true;
            validateForm();
        });
    });

    termsCheckbox.addEventListener("change", validateForm);

    function showError(input, message) {
        input.classList.add("is-invalid");
        input._errorSpan.textContent = message;
    }

    function clearError(input) {
        input.classList.remove("is-invalid");
        input._errorSpan.textContent = "";
    }

    function validateName(name) {
        return /^[A-Za-z\s]+$/.test(name.trim());
    }

    function validatePhone(phone) {
        return /^09\d{9}$/.test(phone.trim());
    }

    function validateEmail(email) {
        return /^[^\s@@]+@@[^\s@@]+\.[^\s@@]+$/.test(email.trim()); // Razor-safe
        }

    function validatePassword(pwd) {
        return pwd.length >= 6;
    }

    function validateForm() {
        let isValid = true;

        // Validate only if touched
        if (touched.firstName && !validateName(inputs.firstName.value)) {
            showError(inputs.firstName, "First name must only contain letters.");
            isValid = false;
        } else {
            clearError(inputs.firstName);
        }

        if (touched.lastName && !validateName(inputs.lastName.value)) {
            showError(inputs.lastName, "Last name must only contain letters.");
            isValid = false;
        } else {
            clearError(inputs.lastName);
        }

        if (touched.phone && !validatePhone(inputs.phone.value)) {
            showError(inputs.phone, "Phone number must start with 09 and have 11 digits.");
            isValid = false;
        } else {
            clearError(inputs.phone);
        }

        if (touched.address && inputs.address.value.trim() === "") {
            showError(inputs.address, "Address is required.");
            isValid = false;
        } else {
            clearError(inputs.address);
        }

        if (touched.email && !validateEmail(inputs.email.value)) {
            showError(inputs.email, "Enter a valid email address.");
            isValid = false;
        } else {
            clearError(inputs.email);
        }

        if (touched.password && !validatePassword(inputs.password.value)) {
            showError(inputs.password, "Password must be at least 6 characters.");
            isValid = false;
        } else {
            clearError(inputs.password);
        }

        if (touched.confirmPassword && inputs.confirmPassword.value !== inputs.password.value) {
            showError(inputs.confirmPassword, "Passwords do not match.");
            isValid = false;
        } else {
            clearError(inputs.confirmPassword);
        }

    }
});
</script>
